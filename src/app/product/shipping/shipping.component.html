<!-- Head Section -->
<!--<div class="head-section bg">
    <div class="container">
        <h4>Shipping <span class="font-light">Product</span></h4>
        <p>Angushop Shipping Product</p>
    </div>
</div> -->




<div class="container-page">
    <div class="box-page">
        <!-- Start List -->
        <!-- <ul class="row list-justify">
             <li class="col s4">
                 Cart
             </li>
             <li class="col s4 active">
                 Delivery
             </li>
             <li class="col s4 disabled">
                 Receipt
             </li>
         </ul> -->
        <!-- End List -->
        <h4 class="mTitle">ОФОРМЛЕННЯ ЗАМОВЛЕННЯ</h4>
        <div class="row margin-top30">
            <div class="col l8 m7 s12">
                <h5>Доставка</h5>
                <div class="row selectcheck">
                    <div class="col m12 s12">
                        <div class="example-container">
                            <form class="example-container" [formGroup]="options">
                                <div class="matDelRadioBtn">
                                    <mat-radio-group>
                                        <mat-radio-button [checked]="true" (click) = "onDeliveryClick('1')" value="1">Доставка до відділення "Нової пошти" по Україні</mat-radio-button>
                                        <mat-radio-button (click) = "onDeliveryClick('2')" value="2">Доставка кур'єром "Нової пошти" по Україні</mat-radio-button>
                                        <mat-radio-button (click) = "onDeliveryClick('3')" value="3">Самовивіз</mat-radio-button>
                                    </mat-radio-group>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                 <div *ngIf="deliveryChoice=='1'" class="accordion shipingMenu">
                     <form #formRef="ngForm" >
                         <div class="row">
                             <div class="col m6 s12 dropshipingnenu">
                                 <h5>Адреса отримувача</h5>
                                 <div class="col m12 s12">
                                     <mat-form-field>
                                         <mat-select placeholder="Область" name="region" required>
                                             <mat-option   *ngFor="let region of regions"  (click) = "onSelectArea(region)" [value]="region.Ref">
                                                 {{ region.Description }}
                                             </mat-option>
                                         </mat-select>
                                     </mat-form-field>
                                 </div>
                                 <div class="col m12 s12">
                                     <!--
                                     <mat-form-field>
                                         <mat-select placeholder="Місто" name="town" required>
                                             <mat-option (click) = "onSelectCity(town)" *ngFor="let town of towns" [value]="town.Ref">
                                                 {{ town.Description }}
                                             </mat-option>
                                         </mat-select>
                                     </mat-form-field>
                                     -->
                                     <mat-form-field>
                                         <input type="text" matInput (focusout) = "onSelectCity()"
                                                name="city" [(ngModel)]="city" [formControl]="cityControl"
                                                [matAutocomplete]="auto" required>
                                     </mat-form-field>
                                     <mat-autocomplete #auto="matAutocomplete">
                                         <mat-option *ngFor="let town of filteredTowns | async" [value]="town" >
                                             {{ town }}
                                         </mat-option>
                                     </mat-autocomplete>
                                 </div>
                                 <div class="col m12 s12">
                                     <mat-form-field>
                                         <mat-select placeholder="Відділення" name="department" required>
                                             <mat-option *ngFor="let department of departments" (click)="onSelectDepartment(department)" [value]="department.Ref">
                                                 {{ department.Description }}
                                             </mat-option>
                                         </mat-select>
                                     </mat-form-field>
                                 </div>
                             </div>
                             <div class="col m6 s12 dropshipingnenu">
                                 <h5>ОТРИМУВАЧ</h5>
                                 <div class="col m12 s12">
                                     <mat-form-field>
                                         <input matInput
                                                type="text"
                                                placeholder="Імʼя"
                                                value=""
                                                name="firstName"
                                                [(ngModel)]="firstName"
                                                #firstNameRef="ngModel"
                                                required>
                                     </mat-form-field>
                                     <small class="error" *ngIf="firstNameRef.errors?.required && firstNameRef.touched">обов'язково до заповнення</small>
                                     <small class="error" *ngIf="firstNameRef.errors?.required && firstNameRef.dirty">обов'язково до заповнення</small>
                                 </div>
                                 <div class="col m12 s12">
                                     <mat-form-field>
                                         <input matInput
                                                type="text"
                                                placeholder="Прізвище"
                                                value=""
                                                name="lastName"
                                                [(ngModel)]="lastName"
                                                #lastNameRef="ngModel"
                                                required>
                                     </mat-form-field>
                                     <small class="error" *ngIf="lastNameRef.errors?.required && lastNameRef.touched">обов'язково до заповнення</small>
                                     <small class="error" *ngIf="lastNameRef.errors?.required && lastNameRef.dirty">обов'язково до заповнення</small>
                                 </div>
                                 <div class="col m12 s12">
                                     <mat-form-field>
                                         <input matInput
                                                type="number"
                                                placeholder="Номер телефону"
                                                value=""
                                                name="phone"
                                                [(ngModel)]="phone"
                                                #phoneRef="ngModel"
                                                required>
                                     </mat-form-field>
                                     <small class="error" *ngIf="phoneRef.errors?.required && phoneRef.touched">обов'язково до заповнення</small>
                                     <small class="error" *ngIf="phoneRef.errors?.required && phoneRef.dirty">обов'язково до заповнення</small>
                                 </div>
                             </div>
                         </div>
                     </form>
                </div>



                <!-- To the dor start-->

                <div *ngIf="deliveryChoice=='2'" class="accordion shipingMenu">
                    <form #formRef="ngForm">
                        <div class="row">
                            <div class="col m6 s12 dropshipingnenu">
                                <h5>Адреса отримувача</h5>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <mat-select placeholder="Область" name="region" required>
                                            <mat-option autofocus *ngFor="let region of regions"  (click) = "onSelectArea(region)" [value]="region.Ref">
                                                {{ region.Description }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input type="text" matInput (focusout) = "onSelectCity()"
                                               name="city" [(ngModel)]="city" [formControl]="cityControl"
                                               [matAutocomplete]="auto" required>
                                    </mat-form-field>
                                    <mat-autocomplete #auto="matAutocomplete">
                                        <mat-option autofocus *ngFor="let town of filteredTowns | async" [value]="town" >
                                            {{ town }}
                                        </mat-option>
                                    </mat-autocomplete>
                                </div>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus matInput
                                               type="text"
                                               placeholder="Вулиця"
                                               value=""
                                               name="street"
                                               [(ngModel)]="street"
                                               #streetRef="ngModel"
                                               required>
                                    </mat-form-field>
                                </div>

                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus matInput
                                               type="text"
                                               placeholder="Дім"
                                               value=""
                                               name="house"
                                               [(ngModel)]="house"
                                               #houseRef="ngModel"
                                               required>
                                    </mat-form-field>
                                </div>

                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus matInput
                                               type="text"
                                               placeholder="Квартира"
                                               value=""
                                               name="flat"
                                               [(ngModel)]="flat"
                                               #flatRef="ngModel"
                                               required>
                                    </mat-form-field>
                                </div>

                            </div>
                            <div class="col m6 s12 dropshipingnenu">
                                <h5>ОТРИМУВАЧ</h5>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus matInput
                                               type="text"
                                               placeholder="Імʼя"
                                               value=""
                                               name="firstName"
                                               [(ngModel)]="firstName"
                                               #firstNameRef="ngModel"
                                               required>
                                    </mat-form-field>
                                    <small class="error" *ngIf="firstNameRef.errors?.required && firstNameRef.touched">обов'язково до заповнення</small>
                                    <small class="error" *ngIf="firstNameRef.errors?.required && firstNameRef.dirty">обов'язково до заповнення</small>
                                </div>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus matInput
                                               type="text"
                                               placeholder="Прізвище"
                                               value=""
                                               name="lastName"
                                               [(ngModel)]="lastName"
                                               #lastNameRef="ngModel"
                                               required>
                                    </mat-form-field>
                                    <small class="error" *ngIf="lastNameRef.errors?.required && lastNameRef.touched">обов'язково до заповнення</small>
                                    <small class="error" *ngIf="lastNameRef.errors?.required && lastNameRef.dirty">обов'язково до заповнення</small>
                                </div>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus matInput
                                               type="number"
                                               placeholder="Номер телефону"
                                               value=""
                                               name="phone"
                                               [(ngModel)]="phone"
                                               #phoneRef="ngModel"
                                               required>
                                    </mat-form-field>
                                    <small class="error" *ngIf="phoneRef.errors?.required && phoneRef.touched">обов'язково до заповнення</small>
                                    <small class="error" *ngIf="phoneRef.errors?.required && phoneRef.dirty">обов'язково до заповнення</small>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- to the dor finish -->

                <div *ngIf="deliveryChoice=='3'" class="accordion shipingMenu">
                    <form #formRef="ngForm">
                        <div class="row">
                            <div class="col m6 s12 dropshipingnenu">
                                <h5>Адреса отримувача</h5>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <mat-select placeholder="Область" name="region" required>
                                            <mat-option autofocus  *ngFor="let region of regions"  (click) = "onSelectArea(region)" [value]="region.Ref">
                                                {{ region.Description }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus type="text" matInput (focusout) = "onSelectCity()"
                                               name="city" [(ngModel)]="city" [formControl]="cityControl"
                                               [matAutocomplete]="auto" required>
                                    </mat-form-field>
                                    <mat-autocomplete #auto="matAutocomplete">
                                        <mat-option autofocus *ngFor="let town of filteredTowns | async" [value]="town" >
                                            {{ town }}
                                        </mat-option>
                                    </mat-autocomplete>
                                </div>

                            </div>
                            <div class="col m6 s12 dropshipingnenu">
                                <h5>ОТРИМУВАЧ</h5>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus matInput
                                               type="text"
                                               placeholder="Імʼя"
                                               value=""
                                               name="firstName"
                                               [(ngModel)]="firstName"
                                               #firstNameRef="ngModel"
                                               required>
                                    </mat-form-field>
                                    <small class="error" *ngIf="firstNameRef.errors?.required && firstNameRef.touched">обов'язково до заповнення</small>
                                    <small class="error" *ngIf="firstNameRef.errors?.required && firstNameRef.dirty">обов'язково до заповнення</small>
                                </div>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus matInput
                                               type="text"
                                               placeholder="Прізвище"
                                               value=""
                                               name="lastName"
                                               [(ngModel)]="lastName"
                                               #lastNameRef="ngModel"
                                               required>
                                    </mat-form-field>
                                    <small class="error" *ngIf="lastNameRef.errors?.required && lastNameRef.touched">обов'язково до заповнення</small>
                                    <small class="error" *ngIf="lastNameRef.errors?.required && lastNameRef.dirty">обов'язково до заповнення</small>
                                </div>
                                <div class="col m12 s12">
                                    <mat-form-field>
                                        <input autofocus matInput
                                               type="number"
                                               placeholder="Номер телефону"
                                               value=""
                                               name="phone"
                                               [(ngModel)]="phone"
                                               #phoneRef="ngModel"
                                               required>
                                    </mat-form-field>
                                    <small class="error" *ngIf="phoneRef.errors?.required && phoneRef.touched">обов'язково до заповнення</small>
                                    <small class="error" *ngIf="phoneRef.errors?.required && phoneRef.dirty">обов'язково до заповнення</small>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!--  end delivery choice  -->


                <h5  class="check">ОПЛАТА</h5>
                <form id='form-id'>
                    <input (change)="payOnCheckout=true"  class="payvar" name='test' type='radio'  /> Оплата карткою VISA/MASTERCARD
                    <br>
                    <input (change)="payOnCheckout=false"  class="payvar" name='test' type='radio' checked /> Оплата при отриманні
                </form>

            </div>
            <div class="col l4 m5 s12">
                <h5>ЗАМОВЛЕННЯ</h5>
                <!-- Start List Produt -->
                <ul class="list-product">
                    <li *ngFor="let product of productsOrder">
                        <div class="wrap-img">
                            <img [src]="product.image" class="img-responsive" alt=""/>
                        </div>
                        <h6 class="title"><a [routerLink]="['/product/' + product.slug]" >{{product.productName}}</a></h6>
                        <p class="margin-top10">
                            <span class="right">{{product.quantity * product.price }} грн.</span>
                            {{product.quantity}}x
                        </p>
                        <a (click)="deleteProduct(product.item.id)"><i class="fa fa-times-circle" aria-hidden="true"></i> видалити</a>
                    </li>
                </ul>
                <!-- End List Produt -->
                <table class="count">
                    <tr>
                        <td>ВСЬОГО ДО СПЛАТИ:</td>
                        <td class="right-align"><strong>{{total  | number}} грн.</strong></td>
                    </tr>
                </table>
                <div class=" l4 m5 s12">
                    <button [disabled]="formRef?.invalid || !isFilled()" mat-button (click)="postOrder()"  class="btn btn-primary btn-block">ОФОРМИТИ ЗАМОВЛЕННЯ</button>
                </div>
            </div>
        </div>

    </div>
</div>